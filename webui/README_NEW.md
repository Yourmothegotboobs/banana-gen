# Banana Gen Web UI - 重构版本

## 概述

这是 Banana Gen Web UI 的重构版本，基于完整的 CLI 功能，提供简洁干净的 Web 界面。

## 特性

### 🎯 核心功能
- **任务管理**: 创建和管理图像生成任务
- **图片来源管理**: 支持本地文件、URL、文件夹、递归文件夹
- **输出文件管理**: 浏览、预览、下载生成的图片
- **系统状态监控**: 实时监控系统组件状态

### 🎨 界面设计
- **现代化 UI**: 基于 Bootstrap 5 的响应式设计
- **简洁布局**: 清晰的导航和功能分区
- **实时反馈**: 状态指示器和进度显示
- **用户友好**: 直观的操作流程

### 🔧 技术特点
- **Flask 后端**: 轻量级 Web 框架
- **RESTful API**: 标准化的 API 接口
- **实时更新**: 自动刷新状态和进度
- **错误处理**: 完善的错误提示和异常处理

## 快速开始

### 1. 启动 Web UI

```bash
cd webui
python start_new.py
```

### 2. 访问界面

打开浏览器访问: http://localhost:8888

### 3. 主要页面

- **首页** (`/`): 系统概览和快速操作
- **任务管理** (`/tasks`): 创建和执行图像生成任务
- **图片来源** (`/sources`): 管理输入图片来源
- **输出文件** (`/outputs`): 浏览和管理生成的图片
- **系统状态** (`/status`): 监控系统组件状态

## 使用指南

### 创建任务

1. 进入 **任务管理** 页面
2. 配置图片来源（本地文件、URL、文件夹等）
3. 选择或输入 Prompt
4. 设置字符串替换规则（可选）
5. 配置输出设置
6. 点击 **创建并执行任务**

### 管理图片来源

1. 进入 **图片来源** 页面
2. 选择图片来源类型：
   - **本地图片**: 上传图片文件
   - **网络图片**: 输入图片 URL
   - **文件夹**: 选择本地图片文件夹
   - **递归文件夹**: 包含子目录的文件夹
3. 配置路径和备用选项
4. 添加到来源列表

### 查看输出

1. 进入 **输出文件** 页面
2. 浏览生成的图片
3. 点击图片预览大图
4. 下载或删除文件
5. 使用搜索功能查找特定文件

### 监控状态

1. 进入 **系统状态** 页面
2. 查看各组件状态
3. 监控任务执行进度
4. 查看系统日志

## 文件结构

```
webui/
├── app_new.py              # 主应用文件
├── start_new.py            # 启动脚本
├── templates/
│   ├── base_new.html       # 基础模板
│   ├── index_new.html      # 首页
│   ├── tasks_new.html      # 任务管理
│   ├── sources_new.html    # 图片来源
│   ├── outputs_new.html    # 输出文件
│   └── status_new.html     # 系统状态
├── uploads/                # 上传文件目录
├── outputs/                # 输出文件目录
└── README_NEW.md          # 说明文档
```

## API 接口

### 任务管理
- `POST /api/tasks/create` - 创建任务
- `POST /api/tasks/start` - 开始执行任务
- `GET /api/tasks/status` - 获取任务状态
- `GET /api/tasks/logs` - 获取任务日志

### 图片来源
- `POST /api/sources/upload` - 上传图片
- `GET /api/sources/folder` - 列出文件夹内容

### 系统状态
- `GET /api/status` - 获取系统状态

## 配置说明

### 环境要求
- Python 3.8+
- Flask
- banana-gen 核心模块

### 端口配置
默认端口: 8888
可在 `app_new.py` 中修改

### 文件路径
- 上传目录: `webui/uploads/`
- 输出目录: `webui/outputs/`

## 故障排除

### 常见问题

1. **模块导入失败**
   - 确保在 banana-gen 项目根目录下运行
   - 检查 Python 路径配置

2. **端口占用**
   - 修改 `app_new.py` 中的端口号
   - 或停止占用端口的其他服务

3. **文件权限问题**
   - 确保对 uploads 和 outputs 目录有写权限
   - 检查文件路径是否正确

### 日志查看
- 控制台输出: 实时查看启动和错误信息
- 系统状态页面: 查看系统组件状态
- 任务管理页面: 查看任务执行日志

## 更新日志

### v2.0.0 (重构版本)
- 完全重构 Web UI
- 基于完整的 CLI 功能
- 现代化的界面设计
- 改进的用户体验
- 完善的错误处理

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 许可证

与 Banana Gen 项目保持一致的许可证。
